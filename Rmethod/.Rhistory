knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(httr, tidyverse)
url<-"https://developers.onemap.sg/commonapi/search"
csv<-read_csv("csv/schools2022.csv")
postcodes<-csv$`postal_code`
found<-data.frame()
not_found<-data.frame()
for(postcode in postcodes){
query<-list('searchVal'=postcode,'returnGeom'='Y','getAddrDetails'='Y','pageNum'='1')
res<- GET(url,query=query)
if((content(res)$found)!=0){
found<-rbind(found,data.frame(content(res))[4:13])
} else{
not_found = data.frame(postcode)
}
}
merged = merge(csv,found, by.x = 'postal_code', by.y = 'results.POSTAL', all = TRUE)
write.csv(merged, file = 'csv/found.csv')
write.csv(not_found, file = "csv/not_found.csv")
url<-"https://developers.onemap.sg/commonapi/search"
csv<-read_csv("csv/schools2022.csv")
postcodes<-csv$`postal_code`
found<-data.frame()
not_found<-data.frame()
for(postcode in postcodes){
query<-list('searchVal'=postcode,'returnGeom'='Y','getAddrDetails'='Y','pageNum'='1')
res<- GET(url,query=query)
if((content(res)$found)!=0){
found<-rbind(found,data.frame(content(res))[4:13])
} else{
not_found = data.frame(postcode)
}
}
merged = merge(csv,found, by.x = 'postal_code', by.y = 'results.POSTAL', all = TRUE)
write.csv(merged, file = 'csv/found.csv')
write.csv(not_found, file = "csv/not_found.csv")
View(found)
View(not_found)
View(merged)
View(merged)
View(not_found)
View(merged)
View(merged)
pacman::p_load(httr, tidyverse)
url<-"https://developers.onemap.sg/commonapi/search"
csv<-read_csv("csv/schools2022.csv")
postcodes<-csv$`postal_code`
found<-data.frame()
not_found<-data.frame()
for(postcode in postcodes){
query<-list('searchVal'=postcode,'returnGeom'='Y','getAddrDetails'='Y','pageNum'='1')
res<- GET(url,query=query)
if((content(res)$found)!=0){
found<-rbind(found,data.frame(content(res))[4:13])
} else{
not_found = data.frame(postcode)
}
}
merged = merge(csv,found, by.x = 'postal_code', by.y = 'results.POSTAL', all = TRUE)
write.csv(merged, file = 'csv/found.csv')
write.csv(not_found, file = "csv/not_found.csv")
View(found)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(httr, tidyverse)
url<-"https://developers.onemap.sg/commonapi/search"
csv<-read_csv("csv/schools_info.csv")
postcodes<-csv$`postal_code`
found<-data.frame()
not_found<-data.frame()
for(postcode in postcodes){
query<-list('searchVal'=postcode,'returnGeom'='Y','getAddrDetails'='Y','pageNum'='1')
res<- GET(url,query=query)
if((content(res)$found)!=0){
found<-rbind(found,data.frame(content(res))[4:13])
} else{
not_found = data.frame(postcode)
}
}
merged = merge(csv,found, by.x = 'postal_code', by.y = 'results.POSTAL', all = TRUE)
write.csv(merged, file = 'csv/found.csv')
write.csv(not_found, file = "csv/not_found.csv")
View(merged)
View(found)
